const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-6us7yB6S.js","assets/wagmi-B9BWfMKM.js","assets/vendor-CalhZtuG.js","assets/reown-DQVHWXW5.js","assets/index-sckPu9ax.js","assets/index-CMcB7MLG.js"])))=>i.map(i=>d[i]);
import{n as D,o as v,S as I,C as U,p as b,U as y,_,P as h,Q as L}from"./wagmi-B9BWfMKM.js";import{x as T}from"./wagmi-B9BWfMKM.js";import"./vendor-CalhZtuG.js";function k(u={}){let f,d,s,r;return D(o=>({id:"baseAccount",name:"Base Account",rdns:"app.base.account",type:"baseAccount",async connect({chainId:t,withCapabilities:e}={}){try{const n=await this.getProvider(),i=(await n.request({method:"eth_requestAccounts",params:[]})).map(a=>v(a));d||(d=this.onAccountsChanged.bind(this),n.on("accountsChanged",d)),s||(s=this.onChainChanged.bind(this),n.on("chainChanged",s)),r||(r=this.onDisconnect.bind(this),n.on("disconnect",r));let c=await this.getChainId();if(t&&c!==t){const a=await this.switchChain({chainId:t}).catch(p=>{if(p.code===y.code)throw p;return{id:c}});c=(a==null?void 0:a.id)??c}return{accounts:e?i.map(a=>({address:a,capabilities:{}})):i,chainId:c}}catch(n){throw/(user closed modal|accounts received is empty|user denied account|request rejected)/i.test(n.message)?new y(n):n}},async disconnect(){const t=await this.getProvider();d&&(t.removeListener("accountsChanged",d),d=void 0),s&&(t.removeListener("chainChanged",s),s=void 0),r&&(t.removeListener("disconnect",r),r=void 0),t.disconnect()},async getAccounts(){return(await(await this.getProvider()).request({method:"eth_accounts"})).map(e=>v(e))},async getChainId(){const e=await(await this.getProvider()).request({method:"eth_chainId"});return Number(e)},async getProvider(){if(!f){const t=(()=>{var i;return typeof u.preference=="string"?{options:u.preference}:{...u.preference,options:((i=u.preference)==null?void 0:i.options)??"all"}})(),{createBaseAccountSDK:e}=await _(async()=>{const{createBaseAccountSDK:i}=await import("./index-6us7yB6S.js");return{createBaseAccountSDK:i}},__vite__mapDeps([0,1,2,3]));f=e({...u,appChainIds:o.chains.map(i=>i.id),preference:t}).getProvider()}return f},async isAuthorized(){try{return!!(await this.getAccounts()).length}catch{return!1}},async switchChain({addEthereumChainParameter:t,chainId:e}){var c,a,p,A;const n=o.chains.find(l=>l.id===e);if(!n)throw new I(new U);const i=await this.getProvider();try{return await i.request({method:"wallet_switchEthereumChain",params:[{chainId:b(n.id)}]}),n}catch(l){if(l.code===4902)try{let w;t!=null&&t.blockExplorerUrls?w=t.blockExplorerUrls:w=(c=n.blockExplorers)!=null&&c.default.url?[(a=n.blockExplorers)==null?void 0:a.default.url]:[];let g;(p=t==null?void 0:t.rpcUrls)!=null&&p.length?g=t.rpcUrls:g=[((A=n.rpcUrls.default)==null?void 0:A.http[0])??""];const C={blockExplorerUrls:w,chainId:b(e),chainName:(t==null?void 0:t.chainName)??n.name,iconUrls:t==null?void 0:t.iconUrls,nativeCurrency:(t==null?void 0:t.nativeCurrency)??n.nativeCurrency,rpcUrls:g};return await i.request({method:"wallet_addEthereumChain",params:[C]}),n}catch(w){throw new y(w)}throw new I(l)}},onAccountsChanged(t){t.length===0?this.onDisconnect():o.emitter.emit("change",{accounts:t.map(e=>v(e))})},onChainChanged(t){const e=Number(t);o.emitter.emit("change",{chainId:e})},async onDisconnect(t){o.emitter.emit("disconnect");const e=await this.getProvider();d&&(e.removeListener("accountsChanged",d),d=void 0),s&&(e.removeListener("chainChanged",s),s=void 0),r&&(e.removeListener("disconnect",r),r=void 0)}}))}S.type="safe";function S(u={}){const{shimDisconnect:f=!1}=u;let d,s;return D(r=>({id:"safe",name:"Safe",type:S.type,async connect({withCapabilities:o}={}){var i;const t=await this.getProvider();if(!t)throw new h;const e=await this.getAccounts(),n=await this.getChainId();return s||(s=this.onDisconnect.bind(this),t.on("disconnect",s)),f&&await((i=r.storage)==null?void 0:i.removeItem("safe.disconnected")),{accounts:o?e.map(c=>({address:c,capabilities:{}})):e,chainId:n}},async disconnect(){var t;const o=await this.getProvider();if(!o)throw new h;s&&(o.removeListener("disconnect",s),s=void 0),f&&await((t=r.storage)==null?void 0:t.setItem("safe.disconnected",!0))},async getAccounts(){const o=await this.getProvider();if(!o)throw new h;return(await o.request({method:"eth_accounts"})).map(v)},async getProvider(){if(typeof window<"u"&&(window==null?void 0:window.parent)!==window){if(!d){const{default:t}=await _(async()=>{const{default:c}=await import("./index-sckPu9ax.js").then(a=>a.e);return{default:c}},__vite__mapDeps([4,2,1])),e=new t(u),n=await L(()=>e.safe.getInfo(),{timeout:u.unstable_getInfoTimeout??10});if(!n)throw new Error("Could not load Safe information");const i=await(async()=>{const c=await _(()=>import("./index-CMcB7MLG.js").then(a=>a.i),__vite__mapDeps([5,2,4,1,3]));return typeof c.SafeAppProvider!="function"&&typeof c.default.SafeAppProvider=="function"?c.default.SafeAppProvider:c.SafeAppProvider})();d=new i(n,e)}return d}},async getChainId(){const o=await this.getProvider();if(!o)throw new h;return Number(o.chainId)},async isAuthorized(){var o;try{return f&&await((o=r.storage)==null?void 0:o.getItem("safe.disconnected"))?!1:!!(await this.getAccounts()).length}catch{return!1}},onAccountsChanged(){},onChainChanged(){},onDisconnect(){r.emitter.emit("disconnect")}}))}export{k as baseAccount,T as injected,S as safe};
//# sourceMappingURL=index-BR8T2mX-.js.map
